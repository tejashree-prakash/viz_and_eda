---
title: "viz_1"
output: html_document
date: "2025-09-25"
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggridges)

#p8105 dataset install and load 
devtools::install_github("p8105/p8105.datasets")
library(p8105.datasets)
```

Import our data. 

```{r}
data("weather_df")
```

```{r}
ggplot(data = weather_df, mapping = aes(x = tmin, y = tmax)) +
  geom_point()
```


```{r}
weather_df %>%
  ggplot(aes(x = tmin,y = tmax)) + 
  geom_point()
```


```{r}
gg_weather_scatterplot = 
  weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point() 

gg_weather_scatterplot
```

Check that some rows are missing. 
```{r}
weather_df %>%
  filter(is.na(tmax))
```

## Fancier scatterplots!

map an aesthetic by something else within an aes(). for example, the color can by mapped by name of variable "(aes(color = name))". you can just set something standard across, like size of the points and do NOT use aes(). "geom_point(alpha = 0.2)". 

```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax, color = name)) + 
  geom_point(alpha = 0.3) + #makes points transparent to visualize density 
  geom_smooth(se = FALSE) #adds the trendlines, but removes the error lines
```


Where you define aesthetics can matter

```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.7) + #uniformly changes all sizes 
  geom_smooth(se = FALSE) 

weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(aes(color = name, , size = prcp), alpha = 0.3) + #size of points dependent on precipitation intensity 
  geom_smooth(se = FALSE)  

```


use faceting real quick 

```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.8) + 
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name) #make multiple plots in a facet layout
                        # row ~ column - separate columns by name (nothing in row, column by name)

weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.8) + 
  geom_smooth(se = FALSE) + 
  facet_grid(name ~ .) # row ~ column - name by row, nothing in column  
```

Let's make a somewhat more interesting scatterplot. 

```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(aes(color = name, size = prcp), alpha = 0.3) + 
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name) 

weather_df %>%
  ggplot(aes(x=tmin, y=tmax, color = name, shape = name)) + 
  geom_point(aes(size = prcp), alpha = 0.3) + 
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name) 
```

Learning assessment 

```{r}
weather_df %>%
  filter(name == "CentralPark_NY") %>% #only want Central Park 
  mutate(
    tmax_fhr = tmax * (9/5) + 32, 
    tmin_fhr = tmin * (9/5) + 32
  ) %>%
  ggplot(aes(x = tmin_fhr, y = tmax_fhr, color = name)) + #doesn't separate by many colors because we have subset to just central park 
    geom_point() + 
    geom_smooth(se = FALSE, method = "lim") #makes linear regression line
```

## Other things we can change

```{r}
#no points
weather_df %>%
  ggplot(aes(x=tmin, y=tmax, color = name, shape = name)) + 
 # geom_point(alpha = 0.3) can comment this out 
  geom_smooth(se = FALSE) 

#points painted on top of the smooth line - order matters 
weather_df %>%
  ggplot(aes(x=tmin, y=tmax, color = name, shape = name)) + 
  geom_smooth(se = FALSE) +
  geom_point() 
```

We can change the spatial density too! 

Use hexes instead of points. We can explicitly see the density change - communicate where data is centered. 
```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_hex()
  
```

Change colors to be specific - not mapping the color, but one standard aesthetic. NOT within an aes, that will map the color. 
```{r}
weather_df %>%
  ggplot(aes(x=tmin, y=tmax)) + 
  geom_point(color = "skyblue") 
```


## Univariate plot kinds! 

Histogram. 
```{r}
weather_df %>%
  ggplot(aes(x = tmin)) + 
  geom_histogram(color = "white", fill = "blue") #color is the outside border aesthetic, and the fill is the inside 
```

Overlapping histograms? Not great
```{r}
weather_df %>%
  ggplot(aes(x = tmin, color = name)) + 
  geom_histogram()

weather_df %>%
  ggplot(aes(x = tmin, fill = name)) + 
  geom_histogram()
```

how would i fix this? A facet!
```{r}
weather_df %>%
  ggplot(aes(x = tmin, fill = name)) + 
  geom_histogram() + 
  facet_grid(name ~ .) # name ~ . stacks vertically 
```


Could also do a density plot? It's kind of like a smooth histogram, but it does some weird things. If you have a gap in your data, a density plot won't always go down to 0. 
```{r}
weather_df %>%
  ggplot(aes(x = tmin, fill = name)) + 
  geom_density(alpha = 0.2) # change transparency of fill!
```


How about a box plot? 

```{r}
weather_df %>%
  ggplot(aes(x = name, y = tmin)) + # name aesthetic to create 3 groups 
  geom_boxplot(aes(fill = name))
```


violin plot 
```{r}
weather_df %>%
  ggplot(aes(x = name, y = tmin, fill = name)) + 
  geom_violin(alpha = 0.2)
```

ridge plot 
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = name))
  geom_density_ridges()
```


Learning Assessment

```{r}
#density plot looks goofy 
weather_df %>%
  ggplot(aes(x = prcp, fill = name)) +
  geom_density(alpha = 0.2)

#histogram also bad 
weather_df %>%
  ggplot(aes(x = prcp, fill = name)) +
  geom_histogram() + 
  facet_grid(name ~ .) #make three rows 

#zoom in to a part of the data
weather_df %>%
  filter(prcp > 5, prcp < 1000) %>% #filter out part of the data - zooming into the middle range
  ggplot(aes(x = prcp, fill = name)) +
    geom_density(alpha = 0.2)
```


## Saving and embedding plots

saving plots 
A plot will want to be saved individually. The first argument is the file path, second argument is the object to save. Optional arguments: width and height. 

```{r}
ggp_weather_plot <- 
  weather_df %>%
  ggplot(aes(x = name, y = tmin, fill = name)) + 
  geom_violin(alpha = 0.2)


ggsave("plots/violin_plot.pdf", ggp_weather_plot, 
       width = 8, height = 6)
```

embedding plots 

This will embed the plot at a particular width and height in the knitted file - doesn't save it outside of R. You can specify the width/height for one specific plot, like if you want this plot to be big. 
```{r, fig.width = 6, fig.height=}
ggp_weather_plot
```

